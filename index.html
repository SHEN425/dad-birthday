<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>è€çˆ¸ç”Ÿæ—¥å¿«ä¹</title>

<style>
html,body{
  margin:0;
  height:100%;
  overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",sans-serif;
  background:radial-gradient(circle at top,#4b2a82,#120016);
  color:white;
}

#center{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10;
}
#card{
  background:rgba(255,255,255,.18);
  border-radius:22px;
  padding:28px 24px;
  width:min(88vw,420px);
  text-align:center;
}
h1{font-size:48px;margin:10px 0}

button{
  border:none;
  border-radius:14px;
  padding:14px 20px;
  margin:10px;
  font-size:16px;
  font-weight:700;
}
#start{background:linear-gradient(135deg,#ffd27a,#ff7ab6);}
#boom{background:rgba(255,255,255,.25);color:white}

#stage{
  position:fixed;
  left:0; right:0;
  top:72px; bottom:36px;
  pointer-events:none;
  z-index:30;
}

.bless{
  position:absolute;
  min-width:180px;
  max-width:75vw;
  padding:14px 20px;
  background:rgba(255,255,255,.28);
  border-radius:20px;
  text-align:center;
  font-size:18px;
  animation:pop 1.2s ease forwards;
}

@keyframes pop{
  0%{opacity:0;transform:scale(.6)}
  40%{opacity:1;transform:scale(1.1)}
  70%{transform:scale(1)}
  100%{opacity:0;transform:scale(.95)}
}

#countdown{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:120px;
  font-weight:900;
  opacity:0;
  transition:.3s;
  z-index:50;
}
#countdown.show{opacity:1}

#final{
  position:fixed;
  inset:0;
  background:radial-gradient(circle,#ff4f87,#050008);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  font-size:clamp(36px,7vw,72px);
  font-weight:900;
  opacity:0;
  pointer-events:none;
  transition:.6s;
  z-index:40;
}
#final.show{opacity:1}
#sign{font-size:24px;margin-top:20px}
</style>
</head>

<body>

<div id="center">
  <div id="card">
    <h1>è€çˆ¸</h1>
    <p>ç‚¹æŒ‰é’®ï¼Œä¸€å®šä¼šåŠ¨ ğŸ‚</p>

    <!-- å…³é”®ï¼šHTML å†…è” onclick -->
    <button id="start" onclick="startBless()">å¼€å§‹ç¥ç¦ ğŸ‰</button>
    <button id="boom"  onclick="boomBless()">ğŸ† ç»ˆææƒŠå–œ</button>
  </div>
</div>

<div id="stage"></div>
<div id="countdown"></div>

<div id="final">
  è€çˆ¸ï¼Œæˆ‘çˆ±ä½  â¤ï¸
  <div id="sign">â€”â€” ä½ äº²çˆ±çš„å¥³å„¿</div>
</div>

<audio id="music" loop>
  <source src="happy.mp3" type="audio/mpeg">
</audio>

<script>
const messages=[
  "è€çˆ¸ç”Ÿæ—¥å¿«ä¹ ğŸ‚","èº«ä½“å¥åº· ğŸ’ª","å¤©å¤©å¼€å¿ƒ ğŸ˜„",
  "ä¸‡äº‹é¡ºæ„ âœ¨","æˆ‘ä»¬éƒ½çˆ±ä½  â¤ï¸","å°‘æ“å¿ƒ å¤šäº«ç¦ â˜€ï¸"
];

const center=document.getElementById("center");
const stage=document.getElementById("stage");
const final=document.getElementById("final");
const music=document.getElementById("music");
const countdown=document.getElementById("countdown");

function vibrate(){
  if(navigator.vibrate) navigator.vibrate([80,40,80]);
}

function popBless(text){
  const d=document.createElement("div");
  d.className="bless";
  d.textContent=text;

  const r=stage.getBoundingClientRect();
  d.style.left=(Math.random()*(r.width-40)+20)+"px";
  d.style.top =(Math.random()*(r.height-40)+20)+"px";

  stage.appendChild(d);
  vibrate();
  setTimeout(()=>d.remove(),1200);
}

function startBless(){
  center.style.display="none";
  music.play().catch(()=>{});
  let i=0;
  const t=setInterval(()=>{
    popBless(messages[i%messages.length]);
    if(++i>=20){
      clearInterval(t);
      setTimeout(()=>center.style.display="flex",1200);
    }
  },350);
}

function boomBless(){
  center.style.display="none";
  music.play().catch(()=>{});
  let n=3;
  countdown.textContent=n;
  countdown.classList.add("show");
  vibrate();

  const c=setInterval(()=>{
    n--;
    if(n>0){
      countdown.textContent=n;
      vibrate();
    }else{
      clearInterval(c);
      countdown.classList.remove("show");
      final.classList.add("show");

      let i=0;
      const t=setInterval(()=>{
        popBless(messages[Math.floor(Math.random()*messages.length)]);
        if(++i>=50){
          clearInterval(t);
          setTimeout(()=>{
            final.classList.remove("show");
            center.style.display="flex";
          },2000);
        }
      },160);
    }
  },900);
}
</script>

</body>
</html>
