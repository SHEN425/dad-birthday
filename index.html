<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>è€çˆ¸ç”Ÿæ—¥å¿«ä¹</title>

<style>
html,body{
  margin:0;
  height:100%;
  overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",sans-serif;
  background:radial-gradient(circle at top,#402060,#090014);
  color:white;
}

/* ä¸­å¿ƒå¡ç‰‡ */
#center{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10;
}
#card{
  background:rgba(255,255,255,.12);
  border:1px solid rgba(255,255,255,.25);
  border-radius:22px;
  padding:28px 22px;
  width:min(90vw,480px);
  text-align:center;
  backdrop-filter:blur(10px);
}
h1{
  font-size:48px;
  margin:10px 0;
  text-shadow:0 0 30px rgba(255,200,150,.8);
}
button{
  border:none;
  border-radius:14px;
  padding:12px 16px;
  margin:6px;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
}
#start{background:linear-gradient(135deg,#ffcc70,#ff6fae);}
#boom{background:rgba(255,255,255,.18);color:white}

/* ç¥ç¦å¡ç‰‡ */
.card{
  position:fixed;
  padding:12px 14px;
  border-radius:16px;
  background:rgba(255,255,255,.18);
  border:1px solid rgba(255,255,255,.25);
  animation:float 3.8s linear forwards;
  pointer-events:none;
}
@keyframes float{
  from{opacity:0;transform:translateY(40px)}
  15%{opacity:1}
  to{opacity:0;transform:translateY(-220px)}
}

/* å€’è®¡æ—¶ */
#countdown{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:120px;
  font-weight:900;
  opacity:0;
  pointer-events:none;
  text-shadow:0 0 40px gold;
  transition:.3s;
  z-index:50;
}
#countdown.show{opacity:1}

/* ç»ˆæç¥ç¦ */
#final{
  position:fixed;
  inset:0;
  background:radial-gradient(circle,#ff4f87,#050008);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  font-size:clamp(34px,7vw,72px);
  font-weight:900;
  opacity:0;
  pointer-events:none;
  transition:.6s;
  z-index:99;
  text-align:center;
}
#final.show{opacity:1}
#sign{
  margin-top:20px;
  font-size:clamp(18px,4vw,28px);
  font-weight:600;
  opacity:.9;
}

/* çƒŸèŠ± */
canvas{
  position:fixed;
  inset:0;
  pointer-events:none;
}
</style>
</head>

<body>

<div id="center">
  <div id="card">
    <h1>è€çˆ¸</h1>
    <p>ç‚¹ä¸€ä¸‹ï¼Œç¥ç¦é©¬ä¸Šâ€œç‚¸å¼€â€ ğŸ‚</p>
    <button id="start">å¼€å§‹ç¥ç¦ ğŸ‰</button>
    <button id="boom">ğŸ’¥ ç»ˆææ¨¡å¼</button>
  </div>
</div>

<div id="countdown"></div>

<div id="final">
  è€çˆ¸ï¼Œæˆ‘çˆ±ä½  â¤ï¸
  <div id="sign">â€”â€” ä½ äº²çˆ±çš„å¥³å„¿</div>
</div>

<canvas id="fireworks"></canvas>

<audio id="music" loop>
  <source src="happy.mp3" type="audio/mpeg">
</audio>

<script>
/* ===== ç¥ç¦è¯­ ===== */
const messages=[
  "è€çˆ¸ç”Ÿæ—¥å¿«ä¹ï¼ğŸ‚","èº«ä½“å¥åº·ï¼ğŸ’ª","å¤©å¤©å¼€å¿ƒï¼ğŸ˜„","ä¸‡äº‹é¡ºæ„ï¼âœ¨",
  "ç¦æ°”æ»¡æ»¡ï¼ğŸ€","å¹³å®‰å–œä¹ï¼ğŸ§§","æˆ‘ä»¬éƒ½çˆ±ä½  â¤ï¸",
  "å°‘æ“å¿ƒï¼Œå¤šäº«ç¦ â˜€ï¸","æ¯å¤©éƒ½æœ‰å¥½å¿ƒæƒ… ğŸŒˆ"
];

/* ===== å®‰å…¨ä½ç½®è®¡ç®—ï¼ˆå¾®ä¿¡/å®‰å“å…œåº•ï¼‰ ===== */
function safePos(){
  const topSafe = 80;    // å¾®ä¿¡æ ‡é¢˜æ 
  const bottomSafe = 60; // æ‰‹åŠ¿åŒº
  const padding = 20;

  return {
    x: Math.random()*(window.innerWidth-padding*2)+padding,
    y: Math.random()*(window.innerHeight-topSafe-bottomSafe)+topSafe
  };
}

/* ===== ç¥ç¦å¡ç‰‡ ===== */
function spawnCard(parent=document.body){
  const d=document.createElement("div");
  d.className="card";
  d.textContent=messages[Math.floor(Math.random()*messages.length)];

  const p=safePos();
  d.style.left=p.x+"px";
  d.style.top=p.y+"px";

  parent.appendChild(d);
  vibrateStrong();
  setTimeout(()=>d.remove(),3800);
}

/* ===== å®‰å“å¯æ„ŸçŸ¥éœ‡åŠ¨ ===== */
function vibrateStrong(){
  if(navigator.vibrate){
    navigator.vibrate([80,40,80]);
  }
}

/* ===== éŸ³ä¹ ===== */
const music=document.getElementById("music");

/* ===== å€’è®¡æ—¶ ===== */
const countdown=document.getElementById("countdown");
function startCountdown(cb){
  let n=3;
  countdown.textContent=n;
  countdown.classList.add("show");
  vibrateStrong();
  const t=setInterval(()=>{
    n--;
    if(n>0){
      countdown.textContent=n;
      vibrateStrong();
    }else{
      clearInterval(t);
      countdown.classList.remove("show");
      cb();
    }
  },900);
}

/* ===== çƒŸèŠ± ===== */
const canvas=document.getElementById("fireworks");
const ctx=canvas.getContext("2d");
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
resize();window.onresize=resize;
let sparks=[];
function firework(x,y){
  for(let i=0;i<40;i++){
    sparks.push({x,y,vx:(Math.random()-.5)*6,vy:(Math.random()-.5)*6,life:50});
  }
}
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  sparks=sparks.filter(p=>p.life-- >0);
  sparks.forEach(p=>{
    p.x+=p.vx;p.y+=p.vy;
    ctx.fillStyle="rgba(255,200,120,.85)";
    ctx.fillRect(p.x,p.y,2,2);
  });
  requestAnimationFrame(loop);
}
loop();

/* ===== è¿”å›åˆå§‹ ===== */
function resetToStart(delay){
  setTimeout(()=>{
    document.getElementById("final").classList.remove("show");
    document.getElementById("center").style.display="flex";
  },delay);
}

/* ===== æŒ‰é’® ===== */
document.getElementById("start").onclick=()=>{
  document.getElementById("center").style.display="none";
  music.play().catch(()=>{});
  for(let i=0;i<30;i++){
    setTimeout(()=>spawnCard(),i*120);
  }
  resetToStart(4200);
};

document.getElementById("boom").onclick=()=>{
  document.getElementById("center").style.display="none";
  music.play().catch(()=>{});
  startCountdown(()=>{
    const final=document.getElementById("final");
    final.classList.add("show");
    for(let i=0;i<90;i++){
      setTimeout(()=>spawnCard(final),i*30);
    }
    firework(innerWidth/2,innerHeight/2);
    resetToStart(5200);
  });
};
</script>

</body>
</html>
